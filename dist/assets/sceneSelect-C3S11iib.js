import"./modulepreload-polyfill-B5Qt9EMX.js";import{initializeApp as y}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";import{getAuth as S,onAuthStateChanged as k}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";import{getFirestore as b,doc as L,getDoc as E}from"https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";const I={apiKey:"AIzaSyD-ldTZ0guWYwolDXmry4cWGWSVIUrtNOo",authDomain:"legendium-2fbb6.firebaseapp.com",projectId:"legendium-2fbb6",storageBucket:"legendium-2fbb6.firebasestorage.app",messagingSenderId:"1080832705555",appId:"1:1080832705555:web:2cdc521dfd5821efe8ebe6",measurementId:"G-JTE4VCMGYS"},f=y(I),v=S(f),w=b(f),l=n=>document.querySelector(n),g=n=>Array.from(document.querySelectorAll(n)),u=new Audio("/sounds/mouse-hover.mp3"),m=new Audio("/sounds/mouse-click.mp3");function r(){u.currentTime=0,u.play().catch(()=>{})}function d(){m.currentTime=0,m.play().catch(()=>{})}function A(n){const a=g("#grid .scene");let e=0,o={};try{const t=localStorage.getItem("completedScenes");t&&(o=JSON.parse(t))}catch(t){console.warn("Error parsing localStorage completedScenes:",t)}const c={...n,...o};return a.forEach(t=>{const i=t.getAttribute("data-scene"),s=!!(c!=null&&c[i]);t.classList.toggle("unlocked",s),t.classList.toggle("locked",!s),s&&e++}),e}function p(n={}){const a=l("#helper"),e=l("#startFresh"),o=l("#continue"),c=g("#grid .scene");let t=A(n),i=null;o.disabled=!0,t===0?(a.textContent="You have not explored any scenes yet. You can start at Scene 1.",e.style.display=""):(a.textContent="Select an explored scene to continue.",e.style.display="none"),c.forEach(s=>{s.addEventListener("mouseenter",()=>{s.classList.contains("unlocked")&&r()}),s.addEventListener("click",()=>{s.classList.contains("unlocked")&&(d(),c.forEach(h=>h.classList.remove("selected")),s.classList.add("selected"),i=s.getAttribute("data-scene"),o.disabled=!1)})}),o.addEventListener("mouseenter",r),e.addEventListener("mouseenter",r),e.addEventListener("click",d),o.addEventListener("click",()=>{i&&(d(),localStorage.setItem("loadScene",i),sessionStorage.setItem("sceneSelected","1"),window.location.href="./experience.html")}),e.addEventListener("click",()=>{localStorage.setItem("loadScene","scene1"),sessionStorage.setItem("sceneSelected","1"),window.location.href="./experience.html"})}k(v,async n=>{const a=document.getElementById("auth-loading");if(a&&(a.style.display="none"),!n){window.location.replace("./index.html");return}try{const e=L(w,"users",n.uid),o=await E(e),c=o.exists()?o.data():{},t=c.scenesCompleted||(c.scenesCompleted===void 0?{scene1:!0}:{});p(t)}catch(e){console.error("Error fetching user data:",e),p({scene1:!0})}});
